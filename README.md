# Схема электронной цифровой подписи ГОСТ Р 34.10-2012 с использованием хэш-функции ГОСТ Р 34.11-2012

---

## I. Общие сведения об электронной подписи

Электронная цифровая подпись (электронная цифровая подпись) сообщения – это строка бит, присоединяемая к сообщению и зависящая от сообщения и секретного элемента данных – ключа подписи, 
известного только его владельцу. Электронная цифровая подпись предназначена для аутентификации лица, подписавшего электронное сообщение. 
Использование электронной цифровой подписи предоставляет возможность обеспечить следующие свойства при передаче в системе подписанного сообщения: 
- **Контроль целостности сообщения**: любая модификация данных приводит к невалидной подписи.
- **Аутентификация автора**: только владелец секретного ключа может создать корректную подпись.
- **Неподделываемость**: без знания приватного ключа невозможно сформировать допустимую подпись.

Существуют два основных подхода к построению схем ЭЦП: 
- **Симметричные схемы** с доверенным посредником (KDC)
  Предусматривает наличие посредника или арбитра, обладающего доверием всех участников информационного обмена. Каждый пользователь имеет с посредником общий ключ шифрования, 
  отличный от аналогичных ключей других пользователей. Эти ключи выдаются пользователям посредником и могут использоваться многократно. Такая схема достаточно хорошо работает, 
  но проблемой является нахождение непогрешимого посредника.
- **Асимметричные схемы** с открытым ключом (основа ГОСТ Р 34.10)
  Схема является наиболее распространенной на сегодняшний день, и именно такие схемы положены в основу действующих государственных стандартов.
  В данном случае каждый участник электронного взаимодействия обладает двумя ключами: ключом подписи и ключом проверки.

Ключевая пара:
- **Ключ подписи (закрытый):** d - представляет собой закрытый ключ, используемый для формирования электронной цифровой подписи и известный только его владельцу
- **Ключ проверки (открытый):** Q - представляет собой открытый ключ, математически связанный с ключом подписи, известный всем участникам электронного взаимодействия и используемый ими для проверки ЭЦП данного участника

---

## II. Основные характеристики ЭЦП ГОСТ Р 34.10-2012

### Общие характеристики стандарта

| Характеристика                  | Значение для ГОСТ Р 34.10-2012                                                    |
|---------------------------------|-----------------------------------------------------------------------------------|
| **Тип криптосистемы**           | Асимметричная, на эллиптических кривых                                            |
| **Поддерживаемые длины ключей** | 256/512 бит                                                                       |
| **Хэш-функция**                 | ГОСТ Р 34.11-2012 (Streebog)                                                      |
| **Стойкость**                   | Основана на сложности ECDLP (Elliptic Curve Discrete Logarithm Problem)           |
| **Стандартизация**              | Российский национальный стандарт (ГОСТ)                                           |
| **Рекомендуемые кривые**        | paramSetA (256/512 бит)                                                           |
| **Область применения**          | Юридически значимая ЭП, защита информации, государственные информационные системы |
| **Скорость работы**             | Высокая (благодаря эффективным операциям на ЭК)                                   |

### Количественные параметры для разных длин ключей

| Параметр                     | 256-битный ключ                                      | 512-битный ключ                                 |
|------------------------------|------------------------------------------------------|-------------------------------------------------|
| **Размер закрытого ключа**   | 256 бит (32 байта)                                   | 512 бит (64 байта)                              |
| **Размер открытого ключа**   | 512 бит (64 байта)                                   | 1024 бит (128 байт)                             |
| **Размер подписи**           | 512 бит (64 байта)                                   | 1024 бит (128 байт)                             |
| **Размер модуля p**          | 256 бит                                              | 512 бит                                         |
| **Порядок подгруппы q**      | 256 бит                                              | 512 бит                                         |
| **Используемая хэш-функция** | Streebog256                                          | Streebog512                                     |
| **Рекомендуемая кривая**     | id-tc26-gost-3410-2012-256-paramSetA                 | id-tc26-gost-3410-2012-512-paramSetA            |
| **Криптостойкость**          | ~2¹²⁸ операций                                       | ~2²⁵⁶ операций                                  |
| **Скорость подписания**      | ~5000 операций/с                                     | ~1500 операций/с                                |
| **Скорость проверки**        | ~3000 операций/с                                     | ~800 операций/с                                 |
| **Рекомендуемые сценарии**   | Электронный документооборот, защищенные каналы связи | Защита гостайны, долгосрочная защита информации |

---

## III. Теоретическое описание работы схемы ЭЦП ГОСТ Р 34.10-2012

Схема ЭЦП ГОСТ Р 34.10-2012 основана на сложности решения задачи дискретного логарифмирования в группе точек эллиптической кривой. 

#### Основные принципы:
1. **Односторонняя функция**: Умножение точки на скаляр: легко вычислить **Q = d·G**, но трудно найти **d** по **Q** и **G** (ECDLP)
2. **Криптографическая стойкость**: Обеспечивается сложностью задачи ECDLP (Elliptic Curve Discrete Logarithm Problem)
3. **Целостность данных**: Гарантируется использованием криптографической хэш-функции Streebog
4. **Аутентификация**: Возможность проверить авторство без раскрытия секретного ключа
5. **Детерминированность**: Для одного сообщения с одним ключом всегда генерируется одна подпись
6. **Зависимость от содержимого**: Любое изменение сообщения делает подпись недействительной

#### Параметры схемы:
1. **p** - простое число (модуль эллиптической кривой)
2. **E** - эллиптическая кривая: y² = x³ + a·x + b (mod p)
3. **m** - порядок группы точек E: p+1-2√p ≤ m ≤ p+1+2√p
4. **q** - порядок циклической подгруппы: 2²⁵⁴ < q < 2²⁵⁶ или 2⁵⁰⁸ < q < 2⁵¹²
5. **P** - базовая точка (генератор подгруппы)
6. **h(·)** - хэш-функция ГОСТ Р 34.11-2012 (l = 256 или 512)
7. **d** - ключ подписи (1 ≤ d ≤ q-1)
8. **Q** - ключ проверки: Q = d·P

---

### 1. Генерация ключевой пары

1. **Выбор длины ключа**  
   - Выбирается размер ключа: 256 или 512 бит  
   - Определяет параметры кривой и хэш-функцию  

2. **Загрузка параметров эллиптической кривой**  
   Для выбранного размера загружаются стандартные параметры:  
   - **p** - модуль конечного поля (простое число)  
   - **a, b** - коэффициенты уравнения кривой  
   - **q** - порядок циклической подгруппы (простое число)  
   - **G = (x_g, y_g)** - базовая точка (генератор подгруппы)  

3. **Генерация случайного числа d**  
   - Генерируется криптографически стойкое случайное число:  
     **d ∈ [1, q-1]**  
   - Это закрытый ключ (ключ подписи)  

4. **Вычисление открытого ключа Q**  
   - Выполняется скалярное умножение точки:  
     **Q = d·G**  
   - Результат - точка на эллиптической кривой:  
     **Q = (x_q, y_q)**  

5. **Сохранение ключей**  
   - Закрытый ключ: **d** (целое число)  
   - Открытый ключ: **Q = (x_q, y_q)** (координаты точки)  

---

### 2. Формирование электронной подписи

Для сообщения **M** и закрытого ключа **d**:

1. Вычислить хэш сообщения:  
   **h = H(M)**, где H - ГОСТ Р 34.11-2012 (Streebog)
   
2. Преобразовать хэш в целое число:  
   **e = h mod q**  
   Если e = 0, установить e = 1
   
3. Сгенерировать случайное число **k** (1 ≤ k ≤ q-1)
   
4. Вычислить точку кривой:  
   **C = k·G = (x<sub>c</sub>, y<sub>c</sub>)**
   
5. Вычислить первую компоненту подписи:  
   **r = x<sub>c</sub> mod q**  
   Если r = 0, вернуться к шагу 3
   
6. Вычислить вторую компоненту подписи:  
   **s = (r·d + k·e) mod q**  
   Если s = 0, вернуться к шагу 3
   
7. Электронная подпись: **σ = (r, s)**

---

### 3. Проверка электронной подписи

Для сообщения **M**, подписи **σ = (r, s)** и открытого ключа **Q**:

1. Проверить диапазон:  
   **1 ≤ r ≤ q-1** и **1 ≤ s ≤ q-1**  
   Если не выполняется - подпись недействительна
   
2. Вычислить хэш сообщения:  
   **h = H(M)**
   
3. Преобразовать хэш:  
   **e = h mod q**  
   Если e = 0, установить e = 1
   
4. Вычислить коэффициенты:  
   **v = e⁻¹ mod q**  
   **z₁ = s·v mod q**  
   **z₂ = (-r)·v mod q**
   
5. Вычислить точку кривой:  
   **C' = z₁·G + z₂·Q = (x'<sub>c</sub>, y'<sub>c</sub>)**
   
6. Вычислить проверочное значение:  
   **R = x'<sub>c</sub> mod q**
   
7. Подпись действительна, если:  
   **R ≡ r (mod q)**

---

## IV. Описание работы программы

Программа реализует алгоритм для формирования и проверки электронной цифровой подписи (ЭЦП) в соответствии со стандартом ГОСТ Р 34.10-2012, 
использующим эллиптические кривые, и хэш-функцией ГОСТ Р 34.11-2012 (Streebog).  
В программе используются заранее определённые наборы параметров эллиптических кривых (ParamSetA) для ключей длиной 256 и 512 бит, 
а также встроенная в библиотеку `gostcrypto` реализация Streebog (256/512) для однонаправленного хэширования.  
Реализованная архитектура программы позволяет не только подробно контролировать каждый шаг криптографических вычислений, 
но и легко расширять или модифицировать реализацию: например, добавлять новые наборы параметров кривых, интегрировать другие хэш-функции или портировать на альтернативные языки программирования.

---

### Ключевые особенности реализации
1. Полное соответствие стандартам ГОСТ:
   - Использование эллиптических кривых (256/512 бит)
   - Интеграция с хэш-функцией Streebog (ГОСТ Р 34.11-2012)
2. Поддержка полного жизненного цикла ЭЦП:
   - Генерация ключевых пар
   - Формирование цифровых подписей
   - Верификация подписей
3. Два режима работы:
   - Интерактивный (диалоговый)
   - Аргументный (командная строка)
4. Криптографические особенности:
   - Эллиптические кривые с параметрами из стандарта ГОСТ Р 34.10-2012:
     - 256-битная кривая: id-tc26-gost-3410-2012-256-paramSetA
     - 512-битная кривая: id-tc26-gost-3410-2012-512-paramSetA
   - Хэш-функция ГОСТ Р 34.11-2012 Streebog:
     - Streebog256 для 256-битных ключей
     - Streebog512 для 512-битных ключей
   - Операции на конечном поле:
     - Сложение и удвоение точек
     - Скалярное умножение
     - Модульная арифметика
   - Использование криптографически стойкого ГСЧ (secrets)
   - Поддержка больших целых чисел для операций с ЭК
5. Реализация на Python 3

---

### Логические модули
1. **Криптографическое ядро**  
   - Хранение параметров кривой (модуль, коэффициенты, базовую точку, порядок группы) для 256- и 512-битных ключей;
   - Вычисление обратного элемента (расширенным алгоритмом Евклида);
   - Складывание двух точек и умножение точки на скаляр (операции на кривой);
   - Хэширование сообщения функцией Streebog;
   - Генерация ключевой пары;
   - Формирование и проверка подписей;
2. **Вспомогательные функции**  
   - Функции работы с файлами (запись/чтение ключей и подписей в шестнадцатеричном формате)
   - Формирование строк вывода результатов для всех этапов работы программы
3. **Интерфейс взаимодействия с пользователем**  
   - Интерактивный режим (поэтапный диалог в консоли с выбором режимов)
   - Аргументный режим (вызов из командной строки с указанием необходимых параметров)
   - Валидация входных данных и обработка ошибок
4. **Точка входа**
   - Выбор режима работы на основании переданных аргументов 
   - Обеспечение корректного выхода из программы при возникновении ошибок или по запросу пользователя

---

### Репозиторий проекта на GitHub
https://github.com/ElijahOrlov/DigitalSignature.git

---

### Структура исходного кода

```text
├── Импорт зависимостей
│   ├── argparse, sys, os, secrets — для работы с командной строкой, файловой системой и генерации случайных чисел
│   └── gostcrypto — для вычисления хэша по ГОСТ Р 34.11-2012
│
├── Класс `GOST34102012`
│   ├── Конфигурация:
│   │   ├── KEY_SET, HASH_SET — выбор параметров
│   │   └── GOST_COEFF — коэффициенты кривых
│   │
│   ├── __init__(size)
│   ├── _compute_mod_inverse(value, modulus)
│   ├── _elliptic_curve_point_addition(point_p, point_q)
│   ├── _scalar_point_multiplication(scalar, point)
│   ├── _calc_message_hash(message)
│   ├── generate_key_pair()
│   ├── compute_signature(private_key, message)
│   └── verify_signature(public_key, message, signature)
│
├── Вспомогательные функции
│   ├── save_key(key, filename, file_attrs=None)
│   ├── load_key(filename, file_attrs=None)
│   ├── genkeys_result(pub_file, priv_file)
│   ├── sign_result(signature_filename, signature_size)
│   └── verify_result(is_valid, data_filename, signature_filename)
│
├── Интерфейс взаимодействия с пользователем
│   ├── interactive_mode() — диалог в консоли: выбор режима (генерация, подписание, проверка)
│   └── arguments_mode() — разбор аргументов командной строки (genkeys, sign, verify)
│
└── Точка входа
    ├── main()
    └── __name__ == "__main__"
```

---

#### Класс `GOST34102012`

**1. Инициализация криптографических параметров `__init__`**
  ```python
  def __init__(self, size: int = 256):
      """
      Инициализация параметров эллиптической кривой.
      :param size: длина ключа (256 или 512 бит)
      """
  ```
  1. Проверка поддерживаемого размера ключа (256/512 бит)
  2. Выбор идентификатора параметров кривой (paramSetA)
  3. Загрузка параметров эллиптической кривой:
     - `p` - модуль конечного поля
     - `a`, `b` - коэффициенты уравнения кривой
     - `q` - порядок циклической подгруппы
     - `base_point` - базовая точка (генератор подгруппы)
  4. Выбор алгоритма хеширования (Streebog256/512)

**2. Вычисление модульной инверсии `_compute_mod_inverse`**
  ```python
  @staticmethod
  def _compute_mod_inverse(value: int, modulus: int) -> int:
      """
      Обратный элемент по модулю (расширенный алгоритм Евклида).
      """
  ```
  1. Проверка корректности входных данных
  2. Использование расширенного алгоритма Евклида
  3. Итеративное обновление коэффициентов Безу
  4. Проверка существования решения (НОД = 1)
  5. Корректировка результата в диапазон [0, modulus-1]
  6. Верификация результата: (value * inverse) % modulus == 1

**3. Сложение точек на эллиптической кривой `_elliptic_curve_point_addition`**
  ```python
  def _elliptic_curve_point_addition(self, point_p, point_q) -> tuple[int,int] | None:
      """
      Сложение двух точек на ко­робе.
      """
  ```
  1. Обработка нейтрального элемента (None = бесконечность)
  2. Проверка на противоположные точки (P + (-P) = O
  3. Расчет коэффициента наклона λ:
     - Для разных точек: λ = (y₂ - y₁)/(x₂ - x₁)
     - Для одинаковых точек: λ = (3x₁² + a)/(2y₁)
  4. Вычисление новых координат:
     - x₃ = λ² - x₁ - x₂
     - y₃ = λ(x₁ - x₃) - y₁
  5. Приведение результатов по модулю p

**4. Умножение точки на скаляр `_scalar_point_multiplication`**
  ```python
  def _scalar_point_multiplication(self, scalar: int, point: tuple[int,int]) -> tuple[int,int]:
      """
      Умножение точки на скаляр методом «double-and-add».
      """
  ```
  1. Инициализация результата как нейтрального элемента
  2. Преобразование скаляра в двоичную форму
  3. Для каждого бита скаляра (от младшего к старшему):
     - Если бит = 1: result = point_addition(result, current)
     - Удвоение текущей точки: current = point_addition(current, current)
  4. Возврат итоговой точки

**5. Вычисление хеш-суммы сообщения `_calc_message_hash`**
  ```python
  def _calc_message_hash(self, message: bytes) -> int:
      """
      Хэширование сообщения Streebog (ГОСТ Р 34.11-2012).
      """
  ```
  1. Инициализация хеш-функции Streebog
  2. Передача бинарных данных в хеш-функцию
  3. Получение дайджеста (32/64 байта)
  4. Преобразование байтов в целое число (little-endian)

**6. Генерация ключевой пары `generate_key_pair`**
  ```python
  def generate_key_pair(self) -> tuple[int, tuple[int,int]]:
      """
      Генерация приватного и публичного ключей.
      """
  ```
  1. Генерация случайного числа d ∈ [1, q-1]
  2. Вычисление публичного ключа Q = d * G
  3. Возврат пары (d, Q)

**7. Создание ЭЦП `compute_signature`**
  ```python
  def compute_signature(self, private_key: int, message: bytes) -> tuple[int,int]:
      """
      Формирование подписи (r, s).
      """
  ```
  1. Вычисление e = hash(message) mod q (с обработкой e=0)
  2. Генерация случайного k ∈ [1, q-1]
  3. Вычисление точки C = k * G
  4. Расчет r = x_C mod q (с проверкой r ≠ 0)
  5. Расчет s = (r·d + k·e) mod q (с проверкой s ≠ 0)
  6. Возврат подписи (r, s)

**8. Проверка подписи `verify_signature`**
  ```python
  def verify_signature(self, public_key: tuple[int,int], message: bytes, signature: tuple[int,int]) -> bool:
      """
      Проверка электронной подписи.
      """
  ```
  1. Проверка диапазона r, s ∈ [1, q-1]
  2. Вычисление e = hash(message) mod q (с обработкой e=0)
  3. Вычисление v = e⁻¹ mod q
  4. Расчет z₁ = s·v mod q
  5. Расчет z₂ = -r·v mod q
  6. Вычисление точки C = z₁·G + z₂·Q
  7. Проверка R = x_C mod q == r

---

#### Вспомогательные функции

**1. Сериализация криптографических объектов `save_key`**
  ```python
  def save_key(key: tuple[int,int] | int, filename: str, file_attrs: list = None) -> int:
      """
      Сохранение ключа или подписи в файл
      (преобразует целое число в шестнадцатеричную строку в нижнем регистре, дополняя ее ведущими нулями до 64 символов;
      если исходное шестнадцатеричное число короче 64 символов, слева добавляются нули; если длиннее, то выводится полностью)
      :param key: Ключ или подпись
      :param filename: Путь к файлу
      :param file_attrs: Аттрибуты файла (наименование)
      :return: Размер записанных данных
      """
  ```
  - Для целых чисел: преобразование в HEX-строку (64 символа)
  - Для точек: сериализация двух координат
  - Запись в файл с отслеживанием имени файла

**2. Десериализация из файла `load_key`**
  ```python
  def load_key(filename: str, file_attrs: list = None) -> tuple[int,int] | int:
      """
      Загрузка ключа или подписи из файла
      :param filename: Имя файла
      :param file_attrs: Аттрибуты файла (наименование)
      :return: Ключ или подпись
      """
  ```
  - Чтение строк из файла
  - Преобразование HEX-строк в целые числа
  - Автоматическое определение типа данных (ключ/подпись)

**3. Строка об успешной генерации ключей `genkeys_result`**
  ```python
  def genkeys_result(pub_file: str, priv_file: str) -> str:
      """
      Выводимый результат генерации ключей
      :param pub_file: имя файла публичного ключа
      :param priv_file: имя файла приватного ключа
      :return: текст результата генерации
      """
  ```

**4. Строка об успешном подписании `sign_result`**
  ```python
  def sign_result(signature_filename: str, signature_size: int) -> str:
      """
      Выводимый результат подписания файла
      :param signature_filename: имя файла подписи
      :param signature_size: размер записанных данных подписи
      :return: текст результата подписания
      """
  ```

**5. строка о результате проверки `verify_result`**
  ```python
  def verify_result(is_valid: bool, data_filename: str, signature_filename: str) -> str:
      """
      Выводимый результат проверки подписи
      :param is_valid: результат проверки
      :param data_filename: имя файла проверяемых данных
      :param signature_filename: имя файла подписи
      :return: текст результата проверки
      """
  ```

---

#### Интерфейс взаимодействия с пользователем

**1. Интерактивный режим `interactive_mode`**
  ```python
  def interactive_mode():
      """Интерактивный режим работы"""
  ```
  - Пошаговый ввод данных через консоль
  - Валидация вводимых данных
  - Обработка файловых операций
  - Циклическое выполнение до команды выхода

**2. Режим командной строки `arguments_mode`**
  ```python
  def arguments_mode():
      """Режим аргументов командной строки"""
  ```
  - Запуск программы с использованием аргументов командной строки argparse
  - Поддержка команд: genkeys, sign, verify
  - Обработка параметров со значениями по умолчанию

---
    
#### Точка входа

**1. Определение режима запуска `main()`**
  ```python
  def main():
      """
      Точка входа в приложение
      """
  ```
  - Вызывает `interactive_mode`, если нет аргументов
  - Вызывает `arguments_mode`, если аргументы указаны
  - При `__name__=="__main__"` запускает `main()`.

---


## V. Режимы запуска программы

Программа поддерживает два режима работы: интерактивный (диалоговый) и командный (через параметры командной строки). 


### Интерактивный режим в консоли

Запуск без параметров:
```shell
python gost_34-10-2012.py
```

**Процесс взаимодействия:**  
1. **Выбор операции**:  
   ```
   Выберите режим работы алгоритма (генерация ключей - [key], подписать файл - [sign], проверить подпись - [verify]): sign
   ```  
   - `key`/`k` — генерация ключевой пары  
   - `sign`/`s` — формирование ЭЦП для файла  
   - `verify`/`v` — проверка подписи  


2. **Генерация ключей**:  
   - Автоматический выбор длины ключа (256/512 бит) по умолчанию 256 бит
   - Указание путей для сохранения ключей:
     ```
     Файл для публичного ключа (по умолчанию public.key): mypub.key  
     Файл для приватного ключа (по умолчанию private.key): mypriv.key
     ```  
   - Подтверждение успешной генерации:
     ```
     Ключевая пара успешно сгенерирована (PUBLIC: 'mypub.key', PRIVATE: 'mypriv.key')!
     ```


3. **Формирование подписи**:  
   - Указание файла для подписи:
     ```
     Укажите файл (в бинарном формате) для подписания (по умолчанию data.bin): document.pdf
     ```  
   - Выбор файла приватного ключа:
     ```
     Укажите приватный ключ (по умолчанию private.key): mypriv.key
     ```  
   - Указание файла для сохранения подписи:
     ```
     Введите путь для сохранения подписи (по умолчанию signature.txt): document.sig
     ```  
   - Подтверждение операции:
     ```
     Подпись успешно сформирована (файл: 'document.sig', записано: 128 байт)
     ```


4. **Проверка подписи**:  
   - Указание файла для проверки:
     ```
     Укажите файл (в бинарном формате) для проверки (по умолчанию data.bin): document.pdf
     ```  
   - Выбор файла подписи:
     ```
     Укажите файл подписи (по умолчанию signature.txt): document.sig
     ```  
   - Указание публичного ключа:
     ```
     Укажите публичный ключ (по умолчанию public.key): mypub.key
     ```  
   - Результат проверки:
     ```
     ✓ Подлинность файла [document.pdf] ПОДТВЕРЖДЕНА
     ```
     или
     ```
     ✗ Подпись [document.sig] НЕДЕЙСТВИТЕЛЬНА
     ```

---

### Командный режим в терминале

```
python gost_34-10-2012.py [-h] {genkeys,sign,verify} ...
```
- `-h`, `--help` — Справочная информация по выбору режима
- `genkeys` — Генерация ключевой пары
- `sign` — Формирование ЭЦП
- `verify` — Проверка подписи


#### 1. Генерация ключей  
```shell
python gost_34-10-2012.py genkeys [-h] [-pub ПУБЛИЧНЫЙ_КЛЮЧ] [-priv ПРИВАТНЫЙ_КЛЮЧ]
```  
- `-h`, `--help` — Справка по режиму генерации  
- `-pub`, `--public` — Файл публичного ключа (по умолчанию: `public.key`)  
- `-priv`, `--private` — Файл приватного ключа (по умолчанию: `private.key`)  

**Пример**:  
```shell
python gost_34-10-2012.py genkeys -pub mypub.key -priv mypriv.key
```


#### 2. Формирование подписи  
```shell
python gost_34-10-2012.py sign [-h] -f ФАЙЛ [-k ПРИВАТНЫЙ_КЛЮЧ] [-o ВЫХОДНОЙ_ФАЙЛ]
```  
- `-h`, `--help` — Справка по режиму подписи  
- `-f`, `--file` — Файл для подписания (обязательный параметр)  
- `-k`, `--key` — Файл приватного ключа (по умолчанию: `private.key`)  
- `-o`, `--output` — Файл для сохранения подписи (по умолчанию: `signature.txt`)  

**Пример**:  
```shell
python gost_34-10-2012.py sign -f document.pdf -k mypriv.key -o document.sig
```


#### 3. Проверка подписи  
```shell
python gost_34-10-2012.py verify [-h] -f ФАЙЛ -s ПОДПИСЬ -k ПУБЛИЧНЫЙ_КЛЮЧ
```  
- `-h`, `--help` — Справка по режиму проверки  
- `-f`, `--file` — Проверяемый файл (обязательный)  
- `-s`, `--signature` — Файл подписи (обязательный)  
- `-k`, `--key` — Файл публичного ключа (обязательный)  

**Пример**:  
```shell
python gost_34-10-2012.py verify -f document.pdf -s document.sig -k mypub.key 
```

**Особенности командного режима**:
- Автоматический выбор размера ключа (256 бит по умолчанию)
- Результаты операций выводятся в консоль
- При ошибках выводятся диагностические сообщения
- Поддерживаются относительные и абсолютные пути к файлам

---

## VI. Примеры вариантов запуска программы

### Тестовые данные

Для проверки работы программы можно использовать следующие тестовые данные:

| Параметр           | Значение                | Формат представления         |
|--------------------|-------------------------|------------------------------|
| Размер ключа       | 256 бит (по умолчанию)  | Автоматический выбор         |
| Публичный ключ     | `mypub.key`             | Два 64-символьных HEX-числа  |
| Приватный ключ     | `mypriv.key`            | Одно 64-символьное HEX-число |
| Подписываемый файл | `document.pdf`          | Бинарный файл                |
| Файл подписи       | `document.sig`          | Два 64-символьных HEX-числа  |

**Содержимое файлов:**
- `document.pdf`:
  ```
  Алгоритм ЭЦП ГОСТ Р 34.10-2012
  ```
- `mypriv.key`:
  ```
  0eafa8b26cdcadbbe6297141aa24367e1a4eb8fed2010c00a7742126dfd8142c
  ```
- `mypub.key`:
  ```
  15daacbfcfb1d281450ddef694823824afcf6ffb30823b406b76df456fb69a9c
  9d66b84224a9a10358ba4e89b0272146f6ad3ec7fa7ce226038ab208f19fcbfa
  ```
- `document.sig`:
  ```
  0f99ed3144e8ef290b603c207b1bfacdb53b2fd0ac220ed94f9f5e3294facc02
  170bf5d2c3403ed7bd444447429c7f185de404ff6599fc070a0d41a0002cdf04
  ```

**Примечания:**
1. Для 256-битных ключей используются 64-символьные HEX-строки
2. Для 512-битных ключей используются 128-символьные HEX-строки
3. Подпись всегда содержит два числа одинаковой длины
4. Программа автоматически определяет размер ключа по длине данных в файле
5. Все файлы сохраняются в текстовом формате UTF-8

---

### Режим 1. Интерактивный в консоли

#### Пример 1.1. Генерация ключевой пары с пользовательскими именами
```
*** Электронная цифровая подпись ГОСТ Р 34.10-2012 ***
--------------------------------------------------------------------------------------------------

Выберите режим работы алгоритма (генерация ключей - [key], подписать файл - [sign], проверить подпись - [verify]): key
Файл для публичного ключа (по умолчанию public.key): mypub.key
Файл для приватного ключа (по умолчанию private.key): mypriv.key

Ключевая пара успешно сгенерирована (PUBLIC: 'mypub.key', PRIVATE: 'mypriv.key')!
```

#### Пример 1.2. Подписание файла с ключом по умолчанию
```
*** Электронная цифровая подпись ГОСТ Р 34.10-2012 ***
--------------------------------------------------------------------------------------------------

Выберите режим работы алгоритма (генерация ключей - [key], подписать файл - [sign], проверить подпись - [verify]): sign
Укажите файл (в бинарном формате) для подписания (по умолчанию data.bin): document.pdf
Укажите приватный ключ (по умолчанию private.key): mypriv.key
Введите путь для сохранения подписи (по умолчанию signature.txt): document.sig

Подпись успешно сформирована (файл: 'document.sig', записано: 128 байт)
```

#### Пример 1.3. Проверка подписи с 512-битным ключом
```
*** Электронная цифровая подпись ГОСТ Р 34.10-2012 ***
--------------------------------------------------------------------------------------------------

Выберите режим работы алгоритма (генерация ключей - [key], подписать файл - [sign], проверить подпись - [verify]): verify
Укажите файл (в бинарном формате) для проверки (по умолчанию data.bin): document.pdf
Укажите файл подписи (по умолчанию signature.txt): document.sig
Укажите публичный ключ (по умолчанию public.key): mypub.key

✓ Подлинность файла [document.pdf] ПОДТВЕРЖДЕНА
```

---

### Режим 2. Командный через терминал с параметрами

#### Пример 2.1. Генерация ключей (с именами по умолчанию)
```bash
python gost_34-10-2012.py genkeys
```

**Результат:**  
```
Ключевая пара успешно сгенерирована (PUBLIC: 'mypub.key', PRIVATE: 'mypriv.key')!
```

**Созданные файлы:**  
- `mypub.key` (публичный ключ)
- `mypriv.key` (приватный ключ)

**Содержимое mypub.key:**  
```
15daacbfcfb1d281450ddef694823824afcf6ffb30823b406b76df456fb69a9c
9d66b84224a9a10358ba4e89b0272146f6ad3ec7fa7ce226038ab208f19fcbfa
```

**Содержимое mypriv.key:**  
```
0eafa8b26cdcadbbe6297141aa24367e1a4eb8fed2010c00a7742126dfd8142c
```

---

#### Пример 2.2. Подписание файла (с пользовательскими параметрами)
```bash
python gost_34-10-2012.py sign -f document.pdf -k mypriv.key -o document.sig
```

**Описание параметров:**  
- `-f`: Файл для подписи (`document.pdf`)  
- `-k`: Приватный ключ (`mypriv.key`)  
- `-o`: Файл подписи (`document.sig`)  

**Результат:**  
```
Подпись успешно сформирована (файл: 'document.sig', записано: 128 байт)
```

**Содержимое document.sig:**  
```
0f99ed3144e8ef290b603c207b1bfacdb53b2fd0ac220ed94f9f5e3294facc02
170bf5d2c3403ed7bd444447429c7f185de404ff6599fc070a0d41a0002cdf04
```

---

#### Пример 2.3. Проверка подписи (со всеми обязательными параметрами)
```bash
python gost_34-10-2012.py verify -f document.pdf -s document.sig -k mypub.key
```

**Описание параметров:**  
- `-f`: Проверяемый файл (`document.pdf`)  
- `-s`: Файл подписи (`document.sig`)  
- `-k`: Публичный ключ (`mypub.key`)  

**Результат при успешной проверке:**  
```
✓ Подлинность файла [document.pdf] ПОДТВЕРЖДЕНА
```

**Результат при недействительной подписи:**  
```
✗ Подпись [document.sig] НЕДЕЙСТВИТЕЛЬНА
```

---

## Заключение
Электронная подпись, реализованная в соответствии с ГОСТ Р 34.10-2012, обеспечивает надежную защиту цифровых данных, 
обеспечивая высокую криптографическую стойкость и эффективность. Основой безопасности алгоритма является сложность решения 
задачи дискретного логарифмирования в группе точек эллиптической кривой (ECDLP), которая обеспечивает защиту даже при 
использовании относительно коротких 256-битных ключей. Ключевым преимуществом стандарта стало сочетание двух фундаментальных 
компонентов: математического аппарата эллиптических кривых и отечественной хэш-функции Streebog (ГОСТ Р 34.11-2012), 
что создает комплексную защиту от современных криптоатак. Использование двух вариантов длины ключей (256 и 512 бит) позволяет 
гибко подходить к выбору уровня безопасности в зависимости от требований конкретной системы. Разработанное решение подтверждает 
практическую применимость стандарта для различных сценариев использования - от повседневного электронного документооборота 
до защиты информации с повышенными требованиями к безопасности. Программа успешно реализует полный цикл работы с ЭЦП, включая 
генерацию ключей, подписание данных и проверку подписей, демонстрируя высокую производительность и соответствие криптографическим 
стандартам Российской Федерации.
